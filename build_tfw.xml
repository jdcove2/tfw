<project name="TheFramework" default="help" basedir=".">
	<description>
		The primary build file for TFW.
	</description>
	
	<!-- The global properties for this build file. -->
	<property name="src" location="src"/>
	<property name="build" location="build"/>
	<property name="buildclasses" location="build/classes"/>
	<property name="buildjars" location="build/jars"/>
	<property name="builddoc" location="build/doc"/>
	<property name="lib" location="lib"/>
	
	<path id="compile.path">
		<fileset dir="lib">
			<include name="junit.jar"/>
			<include name="prefuse_20050401_class.jar"/>
		</fileset>
	</path>
	
	<target name="help">
		<echo message="Usage for TFW ANT build"/>
	</target>
	
	
	<target name="init" description="creates the time stamp and build directory">
		<!-- Create the time stamp -->
		<tstamp/>
		<!-- Create the build directory structure used by compile -->
		<mkdir dir="${buildclasses}"/>
		<mkdir dir="${buildjars}"/>
		<mkdir dir="${builddoc}"/>
	</target>
	
	<target name="compile" depends="init" description="compile the source " >
		<!-- Compile the java code from ${src} into ${build} -->
		<javac srcdir="${src}" destdir="${buildclasses}" 
			classpathref="compile.path"/>
	</target>
	
	<target name="test"  depends="compile" description="Runs all of the unit tests">
		<junit haltonfailure="yes">
			<formatter type="brief" usefile="false" />
			<classpath>
				<pathelement location="${buildclasses}"/>
				<path refid="compile.path"/>
			</classpath>
			<batchtest>
				<fileset dir="${buildclasses}">
					<include name="**/*Test.class" />
					<!-- <exclude name="tfw/immutable/**"/> -->
				</fileset>
			</batchtest>
		</junit>
	</target>
	
	<target name="jarclasses" depends="compile" description="creates class jar file">
		<jar basedir="${buildclasses}" destfile="${buildjars}/tfw_classes0.11.zip"/>
	</target>
	
	<target name="jarsrc" depends="init" description="creates source jar file">
		<jar basedir="${src}" destfile="${buildjars}/tfw_src0.11.zip"/>
	</target>
	
	<target name="jarjavadoc" depends="javadoc" description="creates javadoc jar file">
		<jar basedir="${builddoc}" destfile="${buildjars}/tfw_doc0.11.zip"/>
	</target>
	
	<target name="javadoc" depends="compile" description="generates the javadoc.">
		<javadoc  destdir="${builddoc}" classpathref="compile.path" useexternalfile="yes">
			<packageset dir="src" defaultexcludes="yes">
				<include name="tfw/**"/>
				<exclude name="**/*Test.java"/>
			</packageset>
		</javadoc>
	</target>

	<target name="javadoctsm" depends="compile" description="generates the javadoc.">
		<javadoc  destdir="${builddoc}" classpathref="compile.path" useexternalfile="yes">
			<packageset dir="src" defaultexcludes="yes">
				<include name="tfw/tsm/**"/>
				<include name="tfw/immutable/**"/>
				<exclude name="**/*Test.java"/>
			</packageset>
		</javadoc>
	</target>
	
	<target name="clean" description="deletes the contents of the build directory">
		<delete dir="${build}"/>
	</target>
</project>